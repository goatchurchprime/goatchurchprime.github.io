<!DOCTYPE html>
<html>
<head>
<script src="jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="raphael.js"></script>    
<meta charset="utf-8">
<title>Experimental SVG lattice hinge generator V4</title>
<script>

var paper1 = null; 
var shapeleft = null; 
var shaperight = null; 
var wordsleft = null; 
var wordsright = null; 
var D = null; 

function exportSVG()
{
    var xs = new XMLSerializer();
    var data = document.getElementById("paper1").children[0]; 
    var a = document.createElement('a');
    a.style = "display: none"; 
    var blob = new Blob([xs.serializeToString(data)], {'type':"image/svg+xml"});
    a.href = window.URL.createObjectURL(blob);
    a.download = "test.svg";
    document.body.appendChild(a); 
    a.onclick = function() { document.body.removeChild(a); }; 
    a.click();
}


function makebolt()
{
    var p = paper1; 
    var tbwords = p.path("M61.7810003,9.988 L53.7230003,9.988 L53.7230003,31 L50.3910003,31 L50.3910003,9.988 L42.3330003,9.988 L42.3330003,6.894 L61.7810003,6.894 L61.7810003,9.988 Z M59.7310002,26.614 C59.7310002,23.69 61.8730002,22.058 64.6950002,21.65 L69.1150002,21.004 C70.1010002,20.868 70.3730002,20.358 70.3730002,19.78 C70.3730002,18.182 69.3190002,16.856 66.8370002,16.856 C64.5930002,16.856 63.3350002,18.25 63.1310002,20.154 L60.0710002,19.44 C60.4110002,16.312 63.2330002,14.136 66.7690002,14.136 C71.6650002,14.136 73.5690002,16.924 73.5690002,20.12 L73.5690002,28.314 C73.5690002,29.742 73.7050002,30.592 73.7730002,31 L70.6450002,31 C70.5770002,30.592 70.4750002,29.98 70.4750002,28.79 C69.7610002,29.946 68.1290002,31.51 65.2050002,31.51 C61.8730002,31.51 59.7310002,29.198 59.7310002,26.614 Z M65.6470002,28.824 C68.2650002,28.824 70.3730002,27.566 70.3730002,23.996 L70.3730002,23.248 L65.3750002,23.996 C64.0150002,24.2 62.9950002,24.982 62.9950002,26.444 C62.9950002,27.668 64.0150002,28.824 65.6470002,28.824 Z M80.4950002,31 L77.3330002,31 L77.3330002,6.384 L80.4950002,6.384 L80.4950002,16.958 C81.2770002,15.496 83.1810002,14.17 85.9010002,14.17 C90.8650002,14.17 93.4150002,17.978 93.4150002,22.738 C93.4150002,27.6 90.6610002,31.442 85.7990002,31.442 C83.3850002,31.442 81.5150002,30.388 80.4950002,28.62 L80.4950002,31 Z M90.1510002,22.738 C90.1510002,19.202 88.2810002,16.992 85.3230002,16.992 C82.5010002,16.992 80.4610002,19.202 80.4610002,22.738 C80.4610002,26.274 82.5010002,28.586 85.3230002,28.586 C88.2470002,28.586 90.1510002,26.274 90.1510002,22.738 Z M99.4910001,31 L99.4910001,6.384 L96.2950001,6.384 L96.2950001,31 L99.4910001,31 Z M105.805,21.14 L114.747,21.14 C114.679,18.794 113.149,16.958 110.259,16.958 C107.573,16.958 105.941,19.032 105.805,21.14 Z M115.223,25.39 L117.977,26.342 C117.059,29.232 114.441,31.51 110.633,31.51 C106.247,31.51 102.405,28.314 102.405,22.772 C102.405,17.638 106.111,14.136 110.225,14.136 C115.257,14.136 118.079,17.604 118.079,22.704 C118.079,23.112 118.045,23.52 118.011,23.724 L105.703,23.724 C105.771,26.648 107.879,28.688 110.633,28.688 C113.285,28.688 114.611,27.226 115.223,25.39 Z M121.299,6.894 L129.153,6.894 C133.743,6.894 136.429,9.614 136.429,13.422 C136.429,16.006 134.933,17.842 132.825,18.624 C135.579,19.304 137.177,21.752 137.177,24.438 C137.177,28.246 134.151,31 129.731,31 L121.299,31 L121.299,6.894 Z M124.631,17.434 L128.779,17.434 C131.465,17.434 133.063,15.836 133.063,13.592 C133.063,11.314 131.397,9.818 128.643,9.818 L124.631,9.818 L124.631,17.434 Z M124.631,28.076 L129.255,28.076 C131.941,28.076 133.777,26.58 133.777,24.234 C133.777,21.922 132.315,20.29 129.391,20.29 L124.631,20.29 L124.631,28.076 Z M150.325,29.028 C150.325,29.708 150.393,30.626 150.461,31 L153.521,31 C153.453,30.422 153.351,29.266 153.351,27.974 L153.351,14.646 L150.155,14.646 L150.155,24.506 C150.155,26.988 148.863,28.688 146.279,28.688 C143.593,28.688 142.573,26.716 142.573,24.472 L142.573,14.646 L139.377,14.646 L139.377,24.948 C139.377,28.654 141.689,31.51 145.497,31.51 C147.401,31.51 149.441,30.728 150.325,29.028 Z M160.753,31 L160.753,14.646 L157.591,14.646 L157.591,31 L160.753,31 Z M156.877,8.458 C156.877,9.716 157.897,10.736 159.155,10.736 C160.447,10.736 161.467,9.716 161.467,8.458 C161.467,7.166 160.447,6.146 159.155,6.146 C157.897,6.146 156.877,7.166 156.877,8.458 Z M168.189,31 L168.189,6.384 L164.993,6.384 L164.993,31 L168.189,31 Z M174.333,22.772 C174.333,26.138 176.067,28.62 179.127,28.62 C182.051,28.62 183.853,26.07 183.853,22.704 C183.853,19.338 182.085,17.026 179.161,17.026 C176.237,17.026 174.333,19.406 174.333,22.772 Z M183.887,28.79 L183.887,28.518 C183.105,30.082 181.371,31.442 178.821,31.442 C174.027,31.442 171.069,27.634 171.069,22.772 C171.069,18.148 174.197,14.204 178.821,14.204 C181.711,14.204 183.275,15.632 183.819,16.958 L183.819,6.384 L186.981,6.384 L186.981,27.974 C186.981,29.538 187.117,30.728 187.151,31 L184.057,31 C183.989,30.626 183.887,29.776 183.887,28.79 Z M193.295,21.14 L202.237,21.14 C202.169,18.794 200.639,16.958 197.749,16.958 C195.063,16.958 193.431,19.032 193.295,21.14 Z M202.713,25.39 L205.467,26.342 C204.549,29.232 201.931,31.51 198.123,31.51 C193.737,31.51 189.895,28.314 189.895,22.772 C189.895,17.638 193.601,14.136 197.715,14.136 C202.747,14.136 205.569,17.604 205.569,22.704 C205.569,23.112 205.535,23.52 205.501,23.724 L193.193,23.724 C193.261,26.648 195.369,28.688 198.123,28.688 C200.775,28.688 202.101,27.226 202.713,25.39 Z M217.527,14.476 C217.357,14.442 216.915,14.374 216.473,14.374 C214.807,14.374 212.767,14.986 211.577,17.502 L211.577,14.646 L208.449,14.646 L208.449,31 L211.645,31 L211.645,22.806 C211.645,19.202 213.447,17.774 216.133,17.774 C216.575,17.774 217.051,17.808 217.527,17.876 L217.527,14.476 Z"); 
    var tbbolt = p.path("M12.2285056,0.898846495L22.9814068,0.898846495L16.2492736,12.5388509L26.2536801,12.5388509L4,40L12.8973995,19.5059754L4,19.5059754Z"); 
    var tbrect = p.path("M2,0L9.7,0 M20,0   L28,0A2,2,0,0,1,30,2L30,28 A2,2,0,0,1,28,30 L9,30 M5,30 L2,30 A2,2,0,0,1,0,28 L0,2 A2,2,0,0,1,2,0").transform("t0,5"); 
    var chatch = [ "M9.58333333,14 L9.58333333,20", 
                   "M20.4166667,1.25 L20.4166667,8 M20.4166667,16 L20.4166667,28.8634025", 
                   "M0.416666667,9.58333333 L7,9.58333333 M25,9.58333333 L28.9210523,9.58333333", 
                   "M0.416666667,19.5833333 L8.9210523,19.5833333 M17.0,19.5833333 L28.9210523,19.5833333"
                 ]; 
    var tbhatch = p.path(chatch.join("")).transform("t0,5"); 
    tbwords.attr("stroke", "red"); 
    tbbolt.attr("stroke", "orange"); 
    tbhatch.attr("stroke", "green"); 
    tbrect.attr("stroke", "green"); 
    var tbset = p.set(); 
    tbset.push(tbwords); 
    tbset.push(tbrect, tbbolt, tbhatch); 
    return tbset; 
}


function makesc()
{
    var p = paper1; 
    var tbwords = p.path("M87.9,12.1V26.3H85.6V12.1H80.1V10H93.3v2.1ZM97.7,26.3H95.5V9.6h2.2v6.9a3.7,3.7,0,0,1,3.3-1.6c2.7,0,4,1.9,4,4.4v7h-2.2V19.7c0-1.5-.7-2.8-2.6-2.8-1.7,0-2.5,1.3-2.6,2.9ZM118.1,23.1a5,5,0,0,1-5,3.5,5.51,5.51,0,0,1-5.6-5.5v-.5a5.43,5.43,0,0,1,5.2-5.8h.1c3.4,0,5.3,2.4,5.3,5.8v.7h-8.3a3.4,3.4,0,0,0,3.2,3.4h.1a3,3,0,0,0,3.1-2.2Zm-2.2-3.5a2.78,2.78,0,0,0-2.7-2.8h-.3a3,3,0,0,0-3,2.8ZM135.3,14.4a3.36,3.36,0,0,0-3.5-2.8,2.91,2.91,0,0,0-3.2,2.6v.1a2.46,2.46,0,0,0,2.1,2.4l2.4.5c2.7.6,4.2,2.3,4.2,4.6,0,2.5-2.2,4.8-5.6,4.8-3.9,0-5.8-2.5-6.1-4.9l2.2-.7a3.76,3.76,0,0,0,3.9,3.5h0c2.3,0,3.4-1.2,3.4-2.6a2.57,2.57,0,0,0-2.4-2.5l-2.3-.5c-2.3-.5-4-2-4-4.5a5.28,5.28,0,0,1,5.4-4.9c3.7,0,5.2,2.3,5.5,4.1ZM149.8,23.1a5,5,0,0,1-5,3.5,5.51,5.51,0,0,1-5.6-5.5v-.5a5.43,5.43,0,0,1,5.2-5.8h.1c3.4,0,5.3,2.4,5.3,5.8v.7h-8.3a3.4,3.4,0,0,0,3.2,3.4h.1a3,3,0,0,0,3.1-2.2Zm-2.2-3.5a2.78,2.78,0,0,0-2.7-2.8h-.3a3,3,0,0,0-3,2.8ZM154.8,26.3h-2.2V15.2h2.1v1.6a3.7,3.7,0,0,1,3.4-1.9c2.6,0,4,1.9,4,4.4v7H160V19.7c0-1.5-.6-2.8-2.6-2.8-1.7,0-2.6,1.4-2.6,3ZM166.5,22.7a2.43,2.43,0,0,0,2.6,2.1c1.2,0,1.9-.7,1.9-1.5s-.5-1.2-1.4-1.4l-1.9-.4a3.13,3.13,0,0,1-2.8-3.1,3.76,3.76,0,0,1,3.9-3.5,3.93,3.93,0,0,1,4.2,3l-1.9.7a2.18,2.18,0,0,0-2.3-1.8,1.59,1.59,0,0,0-1.8,1.4c0,.7.4,1.1,1.3,1.3l1.8.4c2,.4,3.1,1.7,3.1,3.3s-1.3,3.4-4.1,3.4c-3,0-4.3-2-4.5-3.2ZM177.1,9.5a1.56,1.56,0,0,1,1.6,1.5,1.55,1.55,0,0,1-3.1.1h0A1.44,1.44,0,0,1,177.1,9.5ZM176,26.3V15.2h2.1V26.3ZM181.8,26.3V9.6H184v7.2a4,4,0,0,1,3.7-1.9c3.4,0,5.1,2.6,5.1,5.8s-1.9,5.9-5.2,5.9a4,4,0,0,1-3.6-1.9v1.6Zm5.4-9.5c-1.9,0-3.3,1.5-3.3,3.9s1.4,4,3.3,4,3.3-1.6,3.3-4-1.3-3.9-3.3-3.9ZM195.5,26.3V9.6h2.2V26.3ZM211,23.1a5,5,0,0,1-5,3.5,5.51,5.51,0,0,1-5.6-5.5v-.5a5.43,5.43,0,0,1,5.2-5.8h.1c3.4,0,5.3,2.4,5.3,5.8v.7h-8.3a3.4,3.4,0,0,0,3.2,3.4h.1a3,3,0,0,0,3.1-2.2Zm-2.2-3.5a2.78,2.78,0,0,0-2.7-2.8h-.3a3,3,0,0,0-3,2.8ZM81,43a8.08,8.08,0,0,1,7.7-8.5h.4c3.7,0,6.4,2,7.2,5.2l-2.1.7a4.79,4.79,0,0,0-5.1-3.8c-3,0-5.8,2.2-5.8,6.4s2.8,6.5,5.8,6.5a5.15,5.15,0,0,0,5.2-3.9l2,.7a7.1,7.1,0,0,1-7.2,5.2C84.9,51.6,81,48.5,81,43ZM109.1,45.7a5.7,5.7,0,0,1-5.7,5.7,5.63,5.63,0,0,1-5.7-5.7h0a5.7,5.7,0,0,1,5.7-5.7,5.63,5.63,0,0,1,5.7,5.7Zm-2.2,0c0-2.6-1.6-3.9-3.5-3.9s-3.4,1.4-3.4,3.9,1.6,4,3.5,4S106.9,48.2,106.9,45.7ZM119.6,49.5a3.61,3.61,0,0,1-3.4,2c-3.2,0-5.2-2.6-5.2-5.9,0-3.1,2.1-5.8,5.2-5.8a3.44,3.44,0,0,1,3.4,1.9V34.5h2.1V49.1a12.75,12.75,0,0,0,.1,2h-2.1a7.57,7.57,0,0,1-.1-1.5Zm-3.2.1c2,0,3.2-1.7,3.2-4s-1.2-3.8-3.2-3.8-3.3,1.6-3.3,3.9S114.3,49.6,116.4,49.6ZM135.1,48a5,5,0,0,1-5,3.5,5.51,5.51,0,0,1-5.6-5.5v-.5a5.43,5.43,0,0,1,5.2-5.8h.1c3.4,0,5.3,2.3,5.3,5.8v.7h-8.3a3.4,3.4,0,0,0,3.2,3.4h.1a3,3,0,0,0,3.1-2.2Zm-2.2-3.5a2.78,2.78,0,0,0-2.7-2.8h-.3a3,3,0,0,0-3,2.8ZM142.9,43a8.08,8.08,0,0,1,7.7-8.5h.4c3.7,0,6.4,2,7.2,5.2l-2.1.7a4.79,4.79,0,0,0-5.1-3.8c-3,0-5.8,2.2-5.8,6.4s2.8,6.5,5.8,6.5a5.15,5.15,0,0,0,5.2-3.9l2,.7a7.29,7.29,0,0,1-7.2,5.3C146.7,51.6,142.9,48.5,142.9,43ZM170.9,45.7a5.7,5.7,0,0,1-5.7,5.7,5.63,5.63,0,0,1-5.7-5.7h0a5.7,5.7,0,0,1,5.7-5.7,5.63,5.63,0,0,1,5.7,5.7Zm-2.2,0c0-2.6-1.6-3.9-3.5-3.9s-3.5,1.4-3.5,3.9,1.6,4,3.5,4,3.5-1.5,3.5-4ZM173.7,51.2V40.1h2.1v1.5a3.81,3.81,0,0,1,3.4-1.8,3.38,3.38,0,0,1,3.3,2.1,3.87,3.87,0,0,1,3.7-2.1c1.9,0,3.8,1.3,3.8,4.2v7.2h-2.1v-7a2.23,2.23,0,0,0-1.9-2.5h-.4a2.65,2.65,0,0,0-2.6,2.6v6.9h-2.2v-7a2.23,2.23,0,0,0-1.9-2.5h-.4a2.56,2.56,0,0,0-2.6,2.5v7ZM193.4,55.6V40.1h2.1v1.7a4.06,4.06,0,0,1,3.7-2c3.3,0,5.1,2.6,5.1,5.8s-1.9,5.8-5.2,5.8a4,4,0,0,1-3.6-1.8v5.9Zm5.4-13.8c-2,0-3.3,1.7-3.3,3.9s1.3,3.9,3.3,3.9,3.3-1.6,3.3-3.9S200.9,41.8,198.8,41.8ZM209.8,44.9l3-.4c.7-.1.9-.4.9-.8,0-1.1-.7-2-2.4-2a2.35,2.35,0,0,0-2.5,2.2h0l-2.1-.5a4.19,4.19,0,0,1,4.5-3.6c3.3,0,4.6,1.9,4.6,4.1v5.5a10.87,10.87,0,0,0,.1,1.8h-2.1a7.57,7.57,0,0,1-.1-1.5,3.94,3.94,0,0,1-3.6,1.8,3.47,3.47,0,0,1-3.7-3.2v-.1C206.4,46.3,207.8,45.1,209.8,44.9Zm3.8,1.6V46l-3.4.5a1.65,1.65,0,1,0,.1,3.3h.1c1.8-.1,3.2-.9,3.2-3.3ZM221.3,51.2h-2.2V40.1h2.1v1.6a3.7,3.7,0,0,1,3.4-1.9c2.6,0,4,1.9,4,4.4v7h-2.2V44.6c0-1.5-.6-2.8-2.6-2.8-1.7,0-2.6,1.4-2.6,3ZM232.5,55.8l2.8-5.8-4.8-9.9H233l3.5,7.7,3.3-7.7h2.3l-7.2,15.7Z")
    var tbs1 = p.path("M48,56.7a30.9,30.9,0,0,0,0-43.6L37.6,23.5A16.19,16.19,0,0,1,14.7,46.4h0L4.4,56.8A30.9,30.9,0,0,0,48,56.7Z"); 
    var tbs2 = p.path("M30.8,0A30.83,30.83,0,0,0,9,52.6L19.4,42.3A16.19,16.19,0,0,1,42.3,19.4L52.6,9A30.72,30.72,0,0,0,30.8,0Z"); 
    tbwords.attr("stroke", "red"); 
    tbs1.attr("stroke", "#aaa"); 
    tbs2.attr("stroke", "#ddd"); 
    var tbset = p.set(); 
    tbset.push(tbs1, tbs2, tbwords); 
    return tbset; 
}

function makeshape(bleft)
{
    var p = paper1; 
    var w = 79; 
    var h = 40; 
    //var rect = p.rect(0, 0, w, h); 
    //var circle = p.circle(24, 18, 7); 
    var crad = 8; 
    var w1 = 23, d1 = 15, w2 = 68, d2 = d1+13; 
    var slotwidth = 3.1; 
    var slottop = "v"+(h/2)+"h"+slotwidth+"v"+(-h/2); 
    var slotbot = "v"+(-h/2)+"h"+(-slotwidth)+"v"+(h/2); 
    var contarr = [ "M", w-crad, ",", h, 
                    "L", crad+slotwidth, ",", h,
                    (!bleft ? slotbot : "h"+(-slotwidth)), 
                    "L", crad, ",", h, "A", crad, ",", crad, ",0,0,1,", "0", ",", h-crad, 
                    "L", 0, ",", crad, "A", crad, ",", crad, ",0,0,1,", crad, ",", 0, 
                    (bleft ? slottop : ""), 
                    "L", w1, ",", 0, "L", w1+d1, ",", d1, 
                    "C", w1+d1+5, ",", d1+5, ",", w2-15, ",", d2-1, ",", w2-3, ",", d2-1,
                    "C", w2+1, ",", d2-1, ",", w2+1, ",", d1+7, ",", w2+1, ",", d1+3,
                    "S", w-4, ",", d1-3, ",", w-1, ",", h-crad-4, 
                    "A", crad, ",", crad*1.15, ",0,0,1,", w-crad, ",", h, 
                    "Z", 
                    "M24,11 A7,7,0,0,1,24,25 A7,7,0,0,1,24,11" 
                  ]; 
console.log(contarr.join("")); 
    var contour = p.path(contarr.join("")); 
    contour.attr({"stroke-width": 0.25})
    return contour; 
}

function setup()
{
    paper1 = Raphael("paper1", 700, 800);
    paper1.setViewBox(-10, -5, 110, 60); 
    
    shapeleft = makeshape(true); 
    shaperight = makeshape(false); 
    shaperight.transform("t0,45..."); 
    shaperight.scale(-1,1); 
    
    wordsleft = makebolt();
    wordsright = makesc(); 
    wordsleft.attr({"stroke-width": 0.25})
    wordsright.attr({"stroke-width": 0.25})

    wordsleft.transform("t15,30s0.2,0.2" + ",0,0"+"t"+(-wordsleft.getBBox().x)+","+(-wordsleft.getBBox().y)+"..."); 
    wordsright.transform("t0,45t22,28s0.15,0.15" + ",0,0"+"t"+(-wordsright.getBBox().x)+","+(-wordsright.getBBox().y)+"..."); 
    
    console.log("hi"); 
    
exportSVG(); 
}

Raphael(setup);   // function to call only *after* page has finished loading

</script>


</head>
<body bgcolor="#e8e8e8">
<div style="border: thin black solid" id="paper1"></div>
  
<p>Code is at <a href="https://bitbucket.org/goatchurch/laserplacer">bitbucket.org/goatchurch/laserplacer</a></p>
</body>
</html>
